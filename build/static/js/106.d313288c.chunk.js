"use strict";(self.webpackChunkrlc=self.webpackChunkrlc||[]).push([[106],{6106:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var s=a(5043),l=a(6213),n=a(3216),i=a(5475),r=a(1899),d=a.n(r),o=(a(5015),a(579));const c=function(){var e;const[t,a]=(0,s.useState)([]),[r,c]=(0,s.useState)(null),[m,h]=(0,s.useState)([]),[p,g]=(0,s.useState)(new Date),[u,v]=(0,s.useState)([]),y=(0,n.zy)(),{booking:N,lang:S,level:x,teacherId:j,lessonTypes:T,schoolId:f}=y.state||{};(0,s.useEffect)((()=>{k(),I()}),[]);const k=async()=>{try{const e=await l.A.get("http://13.60.221.226/api/teacherOrders",{params:{teacherId:j,lessonTypes:T}});if(200===e.status){a(e.data);const t=e.data.flatMap((e=>e.time.filter((e=>e.lang==S&&e.levelName==x&&e.lessonTypes==T&&e.teacherId==j)).map((e=>w(new Date(e.time))))));h(t)}}catch(e){console.error("Error fetching teacher orders:",e)}},I=()=>{if(null!==N&&void 0!==N&&N.level){const e=N.level.filter((e=>e.levelName===x)).flatMap((e=>e.lessonTypes.filter((e=>e.typeName===T)).flatMap((e=>e.date.map((e=>w(new Date(e.d))))))));v(e)}},w=e=>{const t=new Date(e);return t.setHours(0,0,0,0),t};return(0,o.jsxs)("div",{className:"booking-list-container",children:[(0,o.jsxs)("h1",{className:"booking-list-title",children:[S," / ",x," / ",T]}),(0,o.jsx)(i.N_,{to:"/add-booking",state:{booking:N,lang:S,level:x,teacherId:j,lessonTypes:T,schoolId:f},className:"add-booking-btn",children:"Add New Booking"}),(0,o.jsxs)("div",{className:"teachersContent",children:[(0,o.jsxs)("div",{className:"myBookings",children:[(0,o.jsx)("h3",{children:"\u0417\u0430\u043f\u0438\u0441\u0430\u043d\u0456 \u0443\u0447\u043d\u0456"}),(0,o.jsx)("div",{className:"date-picker-container",children:(0,o.jsx)(d(),{selected:r,onChange:e=>c(e),dateFormat:"yyyy-MM-dd",isClearable:!0,placeholderText:"Select a date to filter",inline:!0,highlightDates:m})}),(0,o.jsx)("div",{className:"booking-items",children:(e=>{if(!r)return e;const t=w(r).toISOString().split("T")[0];return e.filter((e=>e.time.some((e=>w(new Date(e.time)).toISOString().split("T")[0]===t))))})(t).flatMap((e=>e.time.filter((e=>{const t=w(new Date(e.time)).toISOString().split("T")[0],a=r?w(r).toISOString().split("T")[0]:null;return e.lang===S&&e.levelName===x&&e.lessonTypes===T&&e.teacherId===j&&(!r||t===a)})).map(((t,s)=>(0,o.jsxs)("div",{className:"teachers-student-block",children:[(0,o.jsxs)("div",{className:"teachers-student-time",children:[new Date(t.time).toLocaleDateString()," ",`${String(new Date(t.time).getUTCHours()).padStart(2,"0")}:${String(new Date(t.time).getUTCMinutes()).padStart(2,"0")}:${String(new Date(t.time).getUTCSeconds()).padStart(2,"0")}`]}),(0,o.jsx)("div",{className:"select",children:(0,o.jsxs)("select",{value:t.payment_status,onChange:s=>(async(e,t,s,n,i,r,d)=>{try{a((t=>t.map((t=>t._id===e?{...t,time:t.time.map((e=>e.time===r?{...e,payment_status:d}:e))}:t)))),await l.A.put("http://13.60.221.226/api/updatePaymentStatus",{orderId:e,teacherId:t,lang:s,levelName:n,lessonTypes:i,time:r,newStatus:d})}catch(o){console.error("Error updating payment status:",o)}})(e._id,t.teacherId,t.lang,t.levelName,t.lessonTypes,t.time,s.target.value),children:[(0,o.jsx)("option",{value:"\u041d\u0435 \u043e\u043f\u043b\u0430\u0447\u0435\u043d\u043e",children:"\u041d\u0435 \u043e\u043f\u043b\u0430\u0447\u0435\u043d\u043e"}),(0,o.jsx)("option",{value:"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e",children:"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e"})]})}),(0,o.jsx)("div",{className:"delete-btn",onClick:()=>(async(e,t,s,n,i,r)=>{try{await l.A.delete("http://13.60.221.226/api/deleteTimeEntry",{data:{orderId:e,teacherId:t,lang:s,levelName:n,lessonTypes:i,time:r}}),a((a=>a.map((a=>a._id===e?{...a,time:a.time.filter((e=>!(e.teacherId===t&&e.lang===s&&e.levelName===n&&e.lessonTypes===i&&e.time===r)))}:a))))}catch(d){console.error("Error deleting time entry:",d)}})(e._id,t.teacherId,t.lang,t.levelName,t.lessonTypes,t.time),children:"\u2716"}),(0,o.jsx)("div",{className:"students-names",children:t.students.map(((e,t)=>(0,o.jsx)("div",{className:"students-names-els",children:(0,o.jsx)("p",{children:e.name})},t)))})]},s)))))})]}),(0,o.jsxs)("div",{className:"myCalendar",children:[(0,o.jsx)("h3",{children:"\u041c\u0456\u0439 \u0433\u0440\u0430\u0444\u0456\u043a"}),(0,o.jsx)("div",{className:"date-picker-container",children:(0,o.jsx)(d(),{selected:p,onChange:e=>g(e),dateFormat:"yyyy-MM-dd",isClearable:!0,placeholderText:"Select a date to filter levels",inline:!0,highlightDates:u})}),(0,o.jsx)("div",{className:"booking-items",children:null===(e=(()=>{if(!p)return null===N||void 0===N?void 0:N.level;const e=w(p).toISOString().split("T")[0];return null===N||void 0===N?void 0:N.level.filter((e=>e.levelName===x)).map((t=>({...t,lessonTypes:t.lessonTypes.filter((e=>e.typeName===T)).map((t=>({...t,date:t.date.filter((t=>w(new Date(t.d)).toISOString().split("T")[0]===e))})))})))})())||void 0===e?void 0:e.map((e=>e.lessonTypes.map((t=>t.date.map(((t,a)=>(0,o.jsx)(i.N_,{to:`/edit-booking/${t.d}`,state:{date:t,lang:S,level:e,teacherId:j,lessonTypes:T,schoolId:f},className:"booking-link",children:(0,o.jsxs)("div",{className:"booking-item",children:[(0,o.jsx)("p",{children:new Date(t.d).toLocaleDateString()})," "]})},a)))))))})]})]})]})}}}]);
//# sourceMappingURL=106.d313288c.chunk.js.map